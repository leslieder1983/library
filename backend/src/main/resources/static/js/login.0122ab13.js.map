{"version":3,"sources":["webpack:///./src/views/Login.vue?7230","webpack:///./src/views/Login.vue","webpack:///./src/views/Login.vue?4d38","webpack:///./src/api/user.js"],"names":["class","style","ref","model","loginForm","rules","loginRules","label-width","status-icon","prop","label","username","type","size","auto-complete","placeholder","password","handleLogin","rememberMe","to","loading","register","setup","store","router","proxy","loginRef","localStorage","getItem","code","required","trigger","message","$refs","validate","valid","value","commit","then","res","jwt","headers","userInfo","data","console","log","push","path","catch","e","__exports__","render","detail","id","request","url","method","params","list","current","page","login","form","update","updatePassword","oldPassword","newPassword","add","del","deleteAll","arr","query"],"mappings":"yGAAA,W,gKCCOA,MAAM,S,uBASP,gCAAiC,MAA7BA,MAAM,SAAQ,cAAU,M,+BA+BvB,Q,6BAcEC,MAAA,iB,+BAC8C,Q,uBAKvD,gCAEM,OAFDD,MAAM,mBAAiB,CAC1B,gCAA8B,YAAxB,uB,qCAEJ,O,gbA/DN,gCA+DM,MA/DN,EA+DM,CA9DJ,yBAyDU,GAxDRE,IAAI,WACHC,MAAO,EAAAC,UACPC,MAAO,EAAAC,WACRN,MAAM,aACNO,cAAY,OACZC,cAAA,I,+BAEA,iBAAiC,CAAjC,EACA,yBAAyD,GAA7CP,MAAA,+BACZ,yBASe,GATDQ,KAAK,WAAWC,MAAM,O,+BAClC,iBAOW,CAPX,yBAOW,G,WANA,EAAAN,UAAUO,S,qDAAV,EAAAP,UAAUO,SAAQ,IAC3BC,KAAK,OACLC,KAAK,QACLC,gBAAc,MACdC,YAAY,M,iCAIhB,yBAUe,GAVDN,KAAK,WAAWC,MAAM,M,+BAClC,iBAQW,CARX,yBAQW,G,WAPA,EAAAN,UAAUY,S,qDAAV,EAAAZ,UAAUY,SAAQ,IAC3BJ,KAAK,WACLC,KAAK,QACLC,gBAAc,MACdC,YAAY,KACX,QAAK,sBAAQ,EAAAE,YAAW,Y,2CAK7B,yBASe,GATDP,MAAM,GAAGT,MAAA,uB,+BACrB,iBAIe,CAJf,yBAIe,G,WAHJ,EAAAG,UAAUc,W,qDAAV,EAAAd,UAAUc,WAAU,IAC7BR,MAAM,OACNG,KAAK,S,uBAEP,yBAEC,GAFYZ,MAAA,kCAAwCkB,GAAI,a,+BACtD,iBAAI,C,sBAGT,yBAce,GAdDlB,MAAA,gBAAmB,C,8BAC/B,iBASY,CATZ,yBASY,GARTmB,QAAS,EAAAA,QACVP,KAAK,QACLD,KAAK,UACLX,MAAA,eACC,QAAK,2BAAU,EAAAgB,YAAW,c,+BAE3B,iBAAgC,CAAnB,EAAAG,S,yBACb,gCAA4B,SAAf,c,yBADb,gCAAgC,SAAV,Y,8BAGQ,EAAAC,U,yBAAhC,gCAEM,MAFN,EAEM,CADJ,yBAAmE,GAAtDrB,MAAM,YAAamB,GAAI,a,+BAAa,iBAAI,C,8FAK3D,I,2DAaW,GACbG,MADa,WAEX,IAAMC,EAAQ,iBACRC,EAAS,iBACf,EAAkB,kCAAVC,EAAR,EAAQA,MACFC,EAAW,mBACXtB,EAAY,iBAAI,CACpBO,SAAUgB,aAAaC,QAAQ,YAC/BZ,SAAUW,aAAaC,QAAQ,YAC/BV,YAAY,EACZW,KAAM,KAGFvB,EAAa,CACjBK,SAAU,CAAC,CAAEmB,UAAU,EAAMC,QAAS,OAAQC,QAAS,aACvDhB,SAAU,CAAC,CAAEc,UAAU,EAAMC,QAAS,OAAQC,QAAS,cAEnDZ,EAAU,kBAAI,GAEdC,EAAW,kBAAI,GAErB,SAASJ,IACPQ,EAAMQ,MAAMP,SAASQ,UAAS,SAACC,GACzBA,IACFf,EAAQgB,OAAQ,EAEZhC,EAAUgC,MAAMlB,WAClBK,EAAMc,OAAO,WAAYjC,EAAUgC,OAGnCb,EAAMc,OAAO,cAGf,eAAMjC,EAAUgC,OACbE,MAAK,SAACC,GACL,IAAMC,EAAMD,EAAIE,QAAQ,iBAClBC,EAAWH,EAAII,KAAKA,KAC1BpB,EAAMc,OAAO,YAAaG,GAC1BjB,EAAMc,OAAO,eAAgBK,GAC7BE,QAAQC,IAAIH,GACZ,eAAU,CACRV,QAAS,OACTpB,KAAM,YAERY,EAAOsB,KAAK,CAAEC,KAAM,qBAErBC,OAAM,SAACC,GACN7B,EAAQgB,OAAQ,EAChB,eAAU,CACRJ,QAASiB,EACTrC,KAAM,mBAMlB,MAAO,CAAER,YAAWE,aAAYW,cAAaS,WAAUN,UAASC,c,iCC3HpE,MAAM6B,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E,gB,uYCPR,SAASC,EAAOC,GACpB,OAASC,eAAQ,CACXC,IAAK,eACLC,OAAQ,MACRC,OAAQ,CACLJ,QAIL,SAASK,EAAKC,EAASC,GAC5B,OAASN,eAAQ,CACXC,IAAK,aACLC,OAAQ,MACRC,OAAQ,CACJE,QAAQA,EACR9C,KAAK+C,KAIV,SAASC,EAAMC,GAEpB,OADAlB,QAAQC,IAAIiB,GACLR,eAAQ,CACVE,OAAO,OACPD,IAAI,SACJZ,KAAI,kBACEmB,KAIN,SAASC,EAAOD,GACpB,OAAOR,eAAQ,CACVE,OAAO,OACPD,IAAI,eACJZ,KAAI,kBACEmB,KAKN,SAASE,EAAeX,EAAGY,EAAYC,GAC5C,OAAOZ,eAAQ,CACVE,OAAO,OACPD,IAAI,iBACJZ,KAAK,CACHU,GAAGA,EACJY,cACAC,iBAUD,SAASC,EAAIL,GAClB,OAAOR,eAAQ,CACVE,OAAO,OACPD,IAAI,YACJZ,KAAI,kBACEmB,KAKL,SAASM,EAAIf,GACnB,OAAOC,eAAQ,CACVE,OAAO,MACPD,IAAI,eACJd,QAAQ,CACL,cAAgBd,aAAaC,QAAQ,UAExC6B,OAAO,CACLJ,QAIF,SAASgB,EAAUC,GACxB,OAAOhB,eAAQ,CACZE,OAAO,OACPD,IAAI,kBACJd,QAAQ,CACL,cAAgBd,aAAaC,QAAQ,UAExCe,KAAK2B,IAIH,SAASC,EAAMT,GACrB,OAAOR,eAAQ,CACZE,OAAO,OACPD,IAAI,cACJd,QAAQ,CACL,cAAgBd,aAAaC,QAAQ,UAExCe,KAAI,kBACEmB","file":"js/login.0122ab13.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Login.vue?vue&type=style&index=0&id=522a9fc0&lang=scss&scoped=true\"","<template>\n  <div class=\"login\">\n    <el-form\n      ref=\"loginRef\"\n      :model=\"loginForm\"\n      :rules=\"loginRules\"\n      class=\"login-form\"\n      label-width=\"70px\"\n      status-icon\n    >\n      <h2 class=\"title\">高校教材订购管理系统</h2>\n      <el-divider style=\"border-color: cadetblue\"></el-divider>\n      <el-form-item prop=\"username\" label=\"用户名\">\n        <el-input\n          v-model=\"loginForm.username\"\n          type=\"text\"\n          size=\"large\"\n          auto-complete=\"off\"\n          placeholder=\"账号\"\n        >\n        </el-input>\n      </el-form-item>\n      <el-form-item prop=\"password\" label=\"密码\">\n        <el-input\n          v-model=\"loginForm.password\"\n          type=\"password\"\n          size=\"large\"\n          auto-complete=\"off\"\n          placeholder=\"密码\"\n          @keyup.enter=\"handleLogin\"\n        >\n        </el-input>\n      </el-form-item>\n\n      <el-form-item label=\"\" style=\"position: relative\">\n        <el-checkbox\n          v-model=\"loginForm.rememberMe\"\n          label=\"记住密码\"\n          size=\"large\"\n        ></el-checkbox>\n        <router-link style=\"position: absolute; right: 0px\" :to=\"'/register'\"\n          >注册账号</router-link\n        >\n      </el-form-item>\n      <el-form-item style=\"width: 100%\">\n        <el-button\n          :loading=\"loading\"\n          size=\"large\"\n          type=\"primary\"\n          style=\"width: 100%\"\n          @click.prevent=\"handleLogin\"\n        >\n          <span v-if=\"!loading\">登 录</span>\n          <span v-else>登 录 中...</span>\n        </el-button>\n        <div style=\"float: right\" v-if=\"register\">\n          <router-link class=\"link-type\" :to=\"'/register'\">立即注册</router-link>\n        </div>\n      </el-form-item>\n    </el-form>\n    <!--  底部  -->\n    <div class=\"el-login-footer\">\n      <span>Copyright © 2022 </span>\n    </div>\n  </div>\n  >\n</template>\n\n<script>\nimport { ref, getCurrentInstance } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\nimport { login } from \"../api/user\";\nimport { ElMessage } from \"element-plus\";\nexport default {\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const { proxy } = getCurrentInstance();\n    const loginRef = ref();\n    const loginForm = ref({\n      username: localStorage.getItem(\"username\"),\n      password: localStorage.getItem(\"password\"),\n      rememberMe: true,\n      code: \"\",\n    });\n\n    const loginRules = {\n      username: [{ required: true, trigger: \"blur\", message: \"请输入正确的账号\" }],\n      password: [{ required: true, trigger: \"blur\", message: \"请输入正确的密码\" }],\n    };\n    const loading = ref(false);\n    // 注册开关\n    const register = ref(false);\n\n    function handleLogin() {\n      proxy.$refs.loginRef.validate((valid) => {\n        if (valid) {\n          loading.value = true;\n          // 勾选了需要记住密码设置在cookie中设置记住用户明和名命\n          if (loginForm.value.rememberMe) {\n            store.commit(\"remember\", loginForm.value);\n          } else {\n            // 否则移除\n            store.commit(\"unRemember\");\n          }\n\n          login(loginForm.value)\n            .then((res) => {\n              const jwt = res.headers[\"authorization\"];\n              const userInfo = res.data.data;\n              store.commit(\"SET_Token\", jwt);\n              store.commit(\"SET_UserInfo\", userInfo);\n              console.log(userInfo);\n              ElMessage({\n                message: \"登录成功\",\n                type: \"success\",\n              });\n              router.push({ path: \"/main/library\" });\n            })\n            .catch((e) => {\n              loading.value = false;\n              ElMessage({\n                message: e,\n                type: \"warning\",\n              });\n            });\n        }\n      });\n    }\n    return { loginForm, loginRules, handleLogin, loginRef, loading, register };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.login {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  background-image: url(\"../assets/images/login.jpg\");\n  background-size: cover;\n}\n.title {\n  margin: 0px auto 30px auto;\n  text-align: center;\n  color: black;\n  opacity: 0.9;\n}\n\n.login-form {\n  border-radius: 10px;\n  background: #ffffff;\n  width: 400px;\n  padding: 25px 25px 5px 25px;\n  .el-input {\n    height: 40px;\n    input {\n      height: 40px;\n    }\n  }\n  .input-icon {\n    height: 39px;\n    width: 14px;\n    margin-left: 0px;\n  }\n}\n.login-tip {\n  font-size: 13px;\n  text-align: center;\n  color: #bfbfbf;\n}\n\n.el-login-footer {\n  height: 40px;\n  line-height: 40px;\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  text-align: center;\n  color: #fff;\n  font-family: Arial;\n  font-size: 12px;\n  letter-spacing: 1px;\n}\n</style>\n","import { render } from \"./Login.vue?vue&type=template&id=522a9fc0&scoped=true\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport \"./Login.vue?vue&type=style&index=0&id=522a9fc0&lang=scss&scoped=true\"\n\nimport exportComponent from \"G:\\\\vueProjects\\\\library\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-522a9fc0\"]])\n\nexport default __exports__","import request from '../utils/request';\r\n\r\nexport function detail(id) {\r\n   return   request({\r\n         url: '/user/detail',\r\n         method: 'get',\r\n         params: {\r\n            id\r\n         }\r\n     })\r\n }\r\nexport function list(current, page) {\r\n  return   request({\r\n        url: '/user/list',\r\n        method: 'get',\r\n        params: {\r\n            current:current,\r\n            size:page\r\n        }\r\n    })\r\n}\r\nexport function login(form){\r\n  console.log(form);\r\n  return request({\r\n       method:\"post\",\r\n       url:\"/login\",\r\n       data:{\r\n          ...form\r\n       }\r\n   })\r\n}\r\nexport function update(form){\r\n   return request({\r\n        method:\"post\",\r\n        url:\"/user/update\",\r\n        data:{\r\n           ...form\r\n        }\r\n    })\r\n }\r\n //重置密码\r\n export function updatePassword(id,oldPassword,newPassword){\r\n   return request({\r\n        method:\"post\",\r\n        url:\"/user/password\",\r\n        data:{\r\n          id:id ,\r\n         oldPassword,\r\n         newPassword\r\n        \r\n        }\r\n    })\r\n }\r\n /**\r\n  * 新增/注册\r\n  * @param {输入参数}} form \r\n  * @returns Promise\r\n  */\r\n export function add(form){\r\n   return request({\r\n        method:\"post\",\r\n        url:\"/user/add\",\r\n        data:{\r\n           ...form\r\n        }\r\n    })\r\n }\r\n\r\n  export function del(id){\r\n   return request({\r\n        method:\"get\",\r\n        url:\"/user/delete\",\r\n        headers:{\r\n           \"Authorization\":localStorage.getItem('token'),\r\n        },\r\n        params:{\r\n          id\r\n        }\r\n    })\r\n }\r\n export function deleteAll(arr){\r\n   return request({\r\n      method:\"post\",\r\n      url:\"/user/deleteAll\",\r\n      headers:{\r\n         \"Authorization\":localStorage.getItem('token'),\r\n      },\r\n      data:arr\r\n  })\r\n }\r\n\r\n export function query(form){\r\n  return request({\r\n     method:\"post\",\r\n     url:\"/user/query\",\r\n     headers:{\r\n        \"Authorization\":localStorage.getItem('token'),\r\n     },\r\n     data:{\r\n        ...form\r\n     }\r\n })\r\n}"],"sourceRoot":""}